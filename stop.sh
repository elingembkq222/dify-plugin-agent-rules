#!/bin/bash

# 停止前端和后端服务的脚本

echo -e "\n\033[1;36m========================================\033[0m"
echo -e "\033[1;35m🛑        停止 Dify Plugin Agent Rules     🛑\033[0m"
echo -e "\033[1;36m========================================\033[0m"

# 检查并停止后端服务（3001端口）
echo -e "\n\033[1;34m🔍 检查后端服务（3001端口）...\033[0m"
if lsof -i :3001 > /dev/null 2>&1; then
    echo -e "\033[1;33m🛑 停止后端服务...\033[0m"
    lsof -ti :3001 | xargs kill -9
    echo -e "\033[1;32m✅ 后端服务已停止\033[0m"
else
    echo -e "\033[1;32mℹ️  后端服务未运行\033[0m"
fi

# 检查并停止前端服务（5173端口）
echo -e "\n\033[1;34m🔍 检查前端服务（5173端口）...\033[0m"
if lsof -i :5173 > /dev/null 2>&1; then
    echo -e "\033[1;33m🛑 停止前端服务...\033[0m"
    lsof -ti :5173 | xargs kill -9
    echo -e "\033[1;32m✅ 前端服务已停止\033[0m"
else
    echo -e "\033[1;32mℹ️  前端服务未运行\033[0m"
fi

echo -e "\n\033[1;36m========================================\033[0m"
echo -e "\033[1;32m🎉 所有服务已停止！\033[0m"
echo -e "\033[1;36m========================================\033[0m"

echo -e "\n\033[1;35m✨ 脚本执行完成！\033[0m"